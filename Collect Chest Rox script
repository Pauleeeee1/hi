wait(10)
print("ASD")
repeat wait() until game:IsLoaded()

local Workspace = game:GetService("Workspace")
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")

repeat wait() until game:IsLoaded()

_G.DebugPrint = false


local function debugPrint(...)
	if _G.DebugPrint then
		print("[DEBUG]", ...)
	end
end

local function GetHumanoid()
	local Player = Players.LocalPlayer
	local Character = Player.Character or Player.CharacterAdded:Wait()
	local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
	local Humanoid = Character:WaitForChild("Humanoid")

	if Humanoid and HumanoidRootPart and Humanoid.Health > 1 then
		warn("Found Humanoid")
		return Humanoid, HumanoidRootPart
	else
		warn("Humanoid or HumanoidRootPart not found")
		return nil, nil
	end
end

local function collectchest()
	for _, descendant in ipairs(workspace:GetDescendants()) do
		if descendant:IsA("ProximityPrompt") then
			fireproximityprompt(descendant)
		end
	end
end
local Humanoid = GetHumanoid()
Humanoid.Health = 0
wait(1)

local Humanoid = GetHumanoid()
if Humanoid then
	-- Wenn das Humanoid-Objekt vorhanden ist, führe dies aus
	print("Humanoid gefunden!")
else
	-- Wenn kein Humanoid-Objekt vorhanden ist, warte, bis es erscheint
	repeat
		wait(0.1)  -- Kurze Pause, um die Schleife nicht zu überlasten
		Humanoid = GetHumanoid()
	until Humanoid

	-- Sobald der Humanoid vorhanden ist, führe dies aus
	print("Humanoid gefunden nach dem Warten!")
end

collectchest()
wait(3)


local function attemptServerHop()
	debugPrint("Attempting server hop...")

	local Player = game.Players.LocalPlayer    
	local Http = game:GetService("HttpService")
	local TeleportService = game:GetService("TeleportService")
	local Api = "https://games.roblox.com/v1/games/"

	local placeId, currentJobId = game.PlaceId, game.JobId
	local serversUrl = Api .. placeId .. "/servers/Public?sortOrder=Desc&limit=100"

	local function ListServers(cursor)
		local url = serversUrl .. (cursor and "&cursor=" .. cursor or "")
		local response = Http:GetAsync(url)
		return Http:JSONDecode(response)
	end

	local nextPageCursor
	local serverToTeleport

	repeat
		local servers = ListServers(nextPageCursor)
		for _, server in ipairs(servers.data) do
			if server.playing < server.maxPlayers and server.id ~= currentJobId then
				local success, result = pcall(function()
					TeleportService:TeleportToPlaceInstance(placeId, server.id, Player)
				end)
				if success then
					serverToTeleport = server
					break
				end
			end
		end
		nextPageCursor = servers.nextPageCursor
	until serverToTeleport or not nextPageCursor

	if serverToTeleport then
		debugPrint("Successfully hopped to server")
		return true
	else
		debugPrint("Failed to find a suitable server to teleport.")
		return false
	end
end

local serverHopped = false
local maxAttempts = 5 -- Maximal five attempts for server hop

-- Attempt server hop up to maxAttempts times
for attempt = 1, maxAttempts do
	serverHopped = attemptServerHop()
	if serverHopped then
		break
	end
	wait(2) -- Wait 2 seconds before attempting again
end

-- If no server hop was successful, perform an alternative action
if not serverHopped then
	debugPrint("No suitable server found after multiple attempts, performing alternative action...")
	attemptServerHop()
end
