wait(10)
repeat wait() until game:IsLoaded()

local Workspace = game:GetService("Workspace")
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")


local player = Players.LocalPlayer
local maxAttempts = 5
local waitTime = 2



repeat wait() until game:IsLoaded()

_G.DebugPrint = false


local function debugPrint(...)
	if _G.DebugPrint then
		print("[DEBUG]", ...)
	end
end

local function GetHumanoid()
	local Player = Players.LocalPlayer
	local Character = Player.Character or Player.CharacterAdded:Wait()
	local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
	local Humanoid = Character:WaitForChild("Humanoid")

	if Humanoid and HumanoidRootPart and Humanoid.Health > 1 then
		warn("Found Humanoid")
		return Humanoid, HumanoidRootPart
	else
		warn("Humanoid or HumanoidRootPart not found")
		return nil, nil
	end
end

local function collectchest()
	for _, descendant in ipairs(workspace:GetDescendants()) do
		if descendant:IsA("ProximityPrompt") then
			fireproximityprompt(descendant)
		end
	end
end
local Humanoid = GetHumanoid()
Humanoid.Health = 0
wait(1)

local Humanoid = GetHumanoid()
if Humanoid then
	-- Wenn das Humanoid-Objekt vorhanden ist, führe dies aus
	print("Humanoid gefunden!")
else
	-- Wenn kein Humanoid-Objekt vorhanden ist, warte, bis es erscheint
	repeat
		wait(0.1)  -- Kurze Pause, um die Schleife nicht zu überlasten
		Humanoid = GetHumanoid()
	until Humanoid

	-- Sobald der Humanoid vorhanden ist, führe dies aus
	print("Humanoid gefunden nach dem Warten!")
end

collectchest()
wait(3)



-- Function to attempt server hopping
local function attemptServerHop()
	debugPrint("Attempting server hop...")

	local placeId = game.PlaceId
	local serversApi = "https://games.roblox.com/v1/games/" .. placeId .. "/servers/Public?sortOrder=Asc&limit=100"
	local nextPageCursor = nil
	local currentJobId = game.JobId

	-- Function to list servers with optional pagination
	local function listServers(cursor)
		local url = serversApi
		if cursor then
			url = url .. "&cursor=" .. cursor
		end

		local response = HttpService:JSONDecode(game:HttpGet(url))
		return response
	end
	
	local availableServers = {}

	-- Fetch server list and find available servers
	repeat
		local serverList = listServers(nextPageCursor)
		if serverList and serverList.data then
			for _, server in ipairs(serverList.data) do
				if server.playing < server.maxPlayers and server.id ~= currentJobId then
					table.insert(availableServers, server)
				end
			end
			nextPageCursor = serverList.nextPageCursor
		end
	until not nextPageCursor

	-- Teleport to a random available server
	if #availableServers > 0 then
		local randomServer = availableServers[math.random(#availableServers)]
		local success, errorMessage = pcall(function()
			TeleportService:TeleportToPlaceInstance(placeId, randomServer.id, player)
		end)
		if success then
			debugPrint("Successfully hopped to server")
			return true
		else
			debugPrint("Teleport failed: " .. errorMessage)
			return false
		end
	else
		debugPrint("No suitable server found to teleport.")
		return false
	end
end

-- Attempt server hop with retries
local serverHopped = false
for attempt = 1, maxAttempts do
	serverHopped = attemptServerHop()
	if serverHopped then
		break
	end
	wait(waitTime) -- Wait before retrying
end

-- Alternative action if no successful server hop
if not serverHopped then
	debugPrint("No suitable server found or no cubes left after multiple attempts, performing alternative action...")
	-- Insert your alternative action here if needed
end
